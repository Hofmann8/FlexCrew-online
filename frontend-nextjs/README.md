# 大连理工大学FlexCrew街舞社官网

### 项目概述
本项目是大连理工大学FlexCrew街舞社的官方网站，提供课程展示、预约管理、社团活动发布等功能。网站采用现代化的设计风格，支持响应式布局，确保在各种设备上都能提供良好的用户体验。

### 技术栈
- 前端：Next.js, React, TypeScript, Tailwind CSS
- 后端：Python, Flask, SQLAlchemy
- 数据库：SQLite (开发), PostgreSQL (生产)

### 主要功能
1. **用户系统**
   - 用户注册、登录和邮箱验证
   - 用户角色：普通社员、舞种领队、超级管理员
   - 个人信息管理

2. **课程管理**
   - 课程展示与周视图日历
   - 课程预约和取消
   - 领队和管理员的课程管理功能

3. **社团信息**
   - 社团介绍与历史
   - 舞种展示
   - 师资力量展示

### 更新日志

#### 2025-04-10 舞种管理功能增强
- 重新设计领队的"我的舞种"页面
- 添加舞种成员查看功能，可查看加入该舞种的所有用户
- 添加近期课程预约情况查看，显示最近10节课的预约人员名单
- 优化数据加载和显示逻辑，提高页面性能
- 改进界面设计，使用表格和卡片布局呈现信息

#### 2025-04-09 精简课程管理功能
- 移除课程归属页面及相关功能
- 删除管理员导航栏中的课程归属选项
- 移除课程卡片中的分配归属按钮
- 优化课程管理流程，简化管理员操作
- 修复课程卡片显示中的类型错误

#### 2025-04-xx 舞种与领队关联优化
- 优化课程管理中舞种与领队的关联逻辑
- 实现舞种与领队账号的一一对应关系
- 简化课程创建/编辑界面，移除领队选择字段
- 添加自动关联提示，提高用户理解
- 确保课程归属分配更加准确和一致

#### 2025-04-xx 课程时间合理性检查
- 增加课程时间输入验证功能
- 前端实现时间输入校验：
  - 确保课程结束时间晚于开始时间
  - 限制课程时长不少于30分钟
  - 限制课程时长不超过4小时
  - 防止无效的时间格式
- 优化错误提示显示，分离显示通用错误和时间相关错误
- 添加用户友好的提示信息，指导用户填写合理的时间段
- 适配后端新增的时间冲突检测功能，妥善处理并显示冲突信息

#### 2025-04-xx 课程时间选择功能优化
- 优化课程管理中的时间选择功能
- 移除固定时间选项的选择列表
- 简化为纯粹的现代化时间选择器
- 改进用户交互体验，使添加和编辑课程更加直观

#### 2025-04-03 课程表显示与预约状态修复
- 修复了周视图课程表无法正确显示的问题
- 优化了课程ID的处理逻辑，确保只显示有效的课程
- 移除了临时课程概念，由数据源保证课程数据的有效性
- 修复了预约状态API请求不正确的问题，确保正确获取课程预约状态
- 改进了课程数据处理流程，确保从后端获取的课程数据经过验证
- 确保只有有效的课程ID才会被用于请求预约状态

#### 2025-04-03 课程表周切换功能修复
- 修复了课程表在点击上一周/下一周按钮时，前端请求参数不更新的问题
- 优化了周切换逻辑，确保切换周时重新加载数据
- 增加了debug日志记录，便于追踪API请求和响应
- 改进了loading状态的处理，提升用户体验

#### 2025-04-02 课程显示与预约问题修复
- 修复了课程表周视图中可能出现undefined课程ID的问题
- 增强了API数据处理的健壮性，确保所有课程数据都经过有效性检查
- 引入临时课程概念，对于无有效ID的课程，前端会为其添加特殊标记
- 临时课程可在界面中显示，但不提供预约功能，避免发送无效的预约请求
- 修复了预约状态查询API调用中可能传入undefined参数的问题
- 增加了更详细的日志记录，便于调试和问题诊断

#### 2025-04-02 后端日期模型更新
- 后端课程模型由使用`weekday`字符串字段改为使用`course_date`日期字段
- 前端适配更改：
  - 添加了新的`/api/schedule`接口支持，用于按周获取课程安排
  - 课程表页面更新为周视图，显示具体日期信息
  - 课程创建/编辑表单更新为使用日期选择器
  - 课程表界面增加了上一周/下一周/本周导航功能

#### 2025-04-01 用户预订功能更新
- 完成了个人信息页的预订课程列表显示
- 添加取消预订功能
- 优化了预订状态的刷新机制

#### 2025-03-30 基础功能完成
- 首页展示与导航功能
- 用户认证系统（登录、注册、验证）
- 课程安排展示与预约
- 管理员和领队后台管理

#### 2025-04-03 课程表数据结构兼容性修复
- 修复了课程表前端无法正确显示后端数据的问题
- 添加了对后端新数据结构的支持：`{ schedule: [{ date, courses: [] }] }`
- 保留对旧数据结构的兼容：`{ date: courses[] }`
- 增强了课程数据处理逻辑，确保正确获取课程计数
- 添加了更详细的日志记录，便于排查问题

#### 2025-04-03 课程表导航按钮优化
- 改进了课程表日期导航按钮的用户体验
- 当显示的是本周时，中间按钮显示"本周课程"并禁用
- 当显示的不是本周时，中间按钮显示"回到本周"并可点击
- 优化了按钮样式和状态，提高交互清晰度
- 添加了判断当前显示周期的逻辑，使界面更直观

#### 2025-04-08 课程预约人数显示优化
- 更新课程表组件，直接使用后端提供的课程预约人数
- 移除通过预约用户数组长度计算预约人数的逻辑
- 优化预约和取消预约后的课程信息更新方式
- 提高课程人数显示的准确性和稳定性
- 支持后端新增的bookedCount字段，简化前端显示逻辑

### 开发与部署

#### 开发环境设置
1. 克隆仓库: `git clone [仓库链接]`
2. 安装前端依赖: `cd frontend-nextjs && npm install`
3. 启动前端开发服务器: `npm run dev`

#### 生产环境部署
1. 构建前端: `npm run build`
2. 启动: `npm start`

### 贡献者
- 开发团队：FlexCrew技术部
- 设计：FlexCrew宣传部

## 功能特点

- 响应式设计，支持各种设备尺寸
- 首页展示社团介绍和特色，配有交互动画效果
- 课程表页面，方便学生查看课程安排
- 现代化UI设计，简洁直观
- 页面滚动动画，提升用户体验
- 平滑滚动效果，增强页面导航体验
- 16:9横版比例图片展示，以四宫格布局呈现活动照片
- 符合规范的ICP备案信息显示
- 详细的课程须知和管理规则说明
- 自定义滚动容器和美观的黄色滚动条
- 用户认证系统，支持登录和注册功能
- 课程预订管理，支持预订和取消课程
- 后台API集成，支持真实数据操作
- 持久化登录状态，页面刷新后保持用户认证

## 新增功能: 课程管理系统

### 管理员功能

- 📋 查看所有课程（所有舞种和公共课程）
- ➕ 创建新课程（可指定舞种和负责领队）
- ✏️ 编辑现有课程的所有信息
- 🗑️ 删除任何课程
- 🔄 管理课程归属（可将课程分配给特定舞种或设为公共课程）
- 📊 查看课程分配统计信息

### 舞种领队功能

- 📋 查看自己舞种的所有课程
- ➕ 创建新课程（自动关联到自己的舞种）
- ✏️ 编辑自己舞种的课程信息
- 🗑️ 删除自己舞种的课程

## 技术栈

- **框架**：Next.js 14
- **样式**：Tailwind CSS
- **字体**：Geist Sans, Geist Mono
- **图标**：React Icons 库，提供多种主流图标集合
- **动画**：使用React Hooks和Intersection Observer实现
- **部署**：可部署到Vercel或其他支持Next.js的平台
- **图片存储**：腾讯云对象存储COS
- **状态管理**：React Context API用于用户认证
- **API集成**：使用Fetch API与后端服务交互
- **通知系统**：React Hot Toast实现交互反馈

## 如何使用

### 环境要求

- Node.js 18.0.0或更高版本
- npm 9.0.0或更高版本

### 安装依赖

```bash
npm install
```

主要依赖项包括：
- `next`: Next.js框架
- `react` 和 `react-dom`: React核心库
- `tailwindcss`: 用于样式的工具类CSS框架
- `react-icons`: 用于提供社交媒体和UI图标
- `react-hot-toast`: 用于显示操作反馈通知

### 开发环境运行

```bash
npm run dev
```

访问 http://localhost:3000 查看网站。

### 构建生产版本

```bash
npm run build
```

### 运行生产版本

```bash
npm start
```

## 环境变量配置

项目使用环境变量来存储敏感信息和配置，以提高安全性和灵活性。请在项目根目录创建 `.env.local` 文件（开发环境）或在生产环境中配置以下环境变量：

```
# 对象存储基础URL
NEXT_PUBLIC_COS_BASE_URL=https://your-bucket-name.cos.region.myqcloud.com
```

**注意**：所有以 `NEXT_PUBLIC_` 开头的环境变量在客户端代码中可见。不要在这些变量中存储敏感信息。

## 图片存储

项目使用腾讯云对象存储服务(COS)托管图片，图片路径格式如下：

```
${NEXT_PUBLIC_COS_BASE_URL}/pages%2Fhome%2F{文件名}
```

在组件中使用图片示例：

```jsx
<Image
  src={`${process.env.NEXT_PUBLIC_COS_BASE_URL}/pages%2Fhome%2Flogo.png`}
  alt="Logo"
  width={200}
  height={200}
/>
```

**注意**：路径中的斜杠必须使用 `%2F` 进行URL编码，否则可能导致403错误。

## 图片资源

项目使用腾讯云对象存储服务(COS)托管图片，图片路径从环境变量获取，格式如下：

```
${NEXT_PUBLIC_COS_BASE_URL}/${NEXT_PUBLIC_COS_HOME_PATH}/{文件名}
```

需要以下图片资源：

1. `logo.png` - 社徽完整版
2. `logo-icon.png` - 社徽icon版本
3. `group-photo.jpg` - 社团大合照（横版）
4. `dance1.jpg` - Cypher活动照片（16:9横版）
5. `dance2.jpg` - 大连高校街舞联盟活动照片（16:9横版）
6. `dance3.png` - 社团日常训练照片（16:9横版）
7. `dance4.jpg` - 街舞支教活动照片（16:9横版）

### Next.js图片配置

由于Next.js的Image组件需要配置远程图片域名，已在`next.config.ts`中动态添加对象存储域名：

```typescript
const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: process.env.NEXT_PUBLIC_COS_BASE_URL ? new URL(process.env.NEXT_PUBLIC_COS_BASE_URL).hostname : '',
        port: '',
        pathname: '/**',
      },
    ],
  },
  // ...其他配置
};
```

如需添加其他远程图片源，请相应修改此配置。

### 腾讯云COS防盗链配置

本项目使用腾讯云COS的Referer防盗链功能保护图片资源。配置如下：

```jsx
// 示例代码
<Image 
  src={`${NEXT_PUBLIC_COS_BASE_URL}/${NEXT_PUBLIC_COS_HOME_PATH}/logo.png`}
  alt="Logo"
  width={200}
  height={200}
  referrerPolicy="origin"  // 添加引用来源策略
/>
```

### 防盗链设置步骤

1. 在腾讯云COS控制台中，为存储桶配置防盗链设置：
   - **Referer 白名单**：添加允许访问的域名
   - **来源验证方式**：设置为"Referer 白名单"

### 具体操作流程

1. 登录腾讯云COS控制台
2. 进入存储桶 → 安全管理 → 防盗链设置
3. 配置以下参数：
   - 防盗链类型：选择"Referer 白名单方式"
   - Referer 白名单：添加您的网站域名（例如：`*.yourdomain.com`）
   - 是否允许空 Referer：根据需求选择（建议选择"否"）

此配置确保仅在白名单域名下才能访问COS中的图片资源，防止他人盗用。

### Hydration警告处理

为了处理可能出现的React Hydration警告（服务端渲染内容与客户端不匹配的情况），已在`layout.tsx`中添加了`suppressHydrationWarning`属性：

```jsx
<body
  suppressHydrationWarning
  className={`${geistSans.variable} ${geistMono.variable} antialiased`}
>
  {/* 内容 */}
</body>
```

这可以避免由于浏览器扩展或第三方脚本导致的非关键hydration警告。

### 自定义滚动容器

网站使用自定义滚动容器替代浏览器原生滚动，具有以下特点：

1. 移除浏览器默认滚动条，使用自定义样式的滚动条
2. 黄色主题的滚动条，与网站整体设计统一
3. 精确的平滑滚动计算，动态适应不同屏幕尺寸和布局

实现方式：

```css
html, body {
  height: 100%;
  overflow: hidden; /* 禁用浏览器默认滚动 */
}

.main-container {
  height: 100vh;
  overflow-y: auto; /* 启用容器滚动 */
  scroll-behavior: smooth;
}

/* 自定义滚动条样式 */
.main-container::-webkit-scrollbar {
  width: 8px;
}

.main-container::-webkit-scrollbar-thumb {
  background: #F59E0B;
  border-radius: 10px;
}
```

### 智能滚动计算

网站实现了动态精确计算的滚动定位系统：

```javascript
const scrollToElement = (elementId) => {
    // 获取目标元素和滚动容器
    const targetElement = document.getElementById(elementId);
    const mainContainer = document.querySelector('.main-container');
    
    if (!targetElement || !mainContainer) return;

    // 计算所有影响滚动位置的因素
    // 1. 导航栏高度（动态获取）
    const navbar = document.querySelector('nav');
    const navbarHeight = navbar ? navbar.getBoundingClientRect().height : 80;
    
    // 2. 计算目标元素相对于容器的准确位置
    const targetRect = targetElement.getBoundingClientRect();
    const containerRect = mainContainer.getBoundingClientRect();
    const currentScrollTop = mainContainer.scrollTop;
    const relativeTop = targetRect.top - containerRect.top + currentScrollTop;
    
    // 3. 根据不同部分调整额外偏移量
    let additionalOffset = elementId === 'about' ? 20 : 0;
    
    // 最终滚动位置计算
    const scrollToPosition = relativeTop - navbarHeight - additionalOffset;
    
    // 执行平滑滚动
    mainContainer.scrollTo({
        top: scrollToPosition,
        behavior: 'smooth'
    });
};
```

这种实现方式具有以下优势：

1. 动态获取导航栏高度，适应不同设备和布局变化
2. 精确计算目标元素在滚动容器中的相对位置
3. 考虑当前滚动位置，确保滚动到正确的目标位置
4. 为不同部分设置独立的偏移量调整，优化视觉体验

### ICP备案信息

网站底部已添加了符合规范的ICP备案信息链接：

```jsx
<a 
  href="https://beian.miit.gov.cn/" 
  target="_blank" 
  rel="noopener noreferrer"
  className="hover:text-gray-400 transition-colors flex items-center"
>
  {/* 信息图标 */}
  辽ICP备2025051480号-1
</a>
```

备案信息链接到工信部备案管理系统网站，符合中国大陆网站备案要求。

### 课程管理规则

课表页面包含详细的课程须知和管理规则，包括：

- 课程预约规则：预约时间、取消方式和注意事项
- 课表执行说明：除特殊情况外严格按照课表时间上课
- 排课规则：各舞种领队可视情况私下排课，但不可影响正常课程
- 免费承诺：所有常规课程均免费，严禁私自收费
- 管理联系方式：提供管理部负责人联系方式，方便举报和咨询

这些规则确保了街舞社课程的有序进行和资源的公平分配。

## 用户认证系统

网站实现了完整的用户认证系统，支持以下功能：

- 用户注册：用户可以创建新账户，提供用户名、邮箱和密码
- 用户登录：已注册用户可以使用凭据登录系统
- 状态管理：使用React Context API管理全局用户状态
- 权限控制：基于登录状态动态显示/隐藏内容

认证系统具有以下特点：

1. 使用JWT（JSON Web Token）进行用户身份验证
2. 实现安全的密码处理和验证
3. 提供用户个人信息页面，可查看和管理个人资料
4. 根据用户登录状态显示不同的导航选项
5. 登录状态持久化，避免页面刷新后丢失登录状态

### 用户认证流程

```javascript
// AuthContext.tsx 核心代码片段
const login = async (username: string, password: string) => {
  try {
    setIsLoading(true);
    const response = await loginUser(username, password);
    
    if (response.token) {
      localStorage.setItem('token', response.token);
      setUser(response.user);
      setIsAuthenticated(true);
      return { success: true };
    }
    return { success: false, error: '登录失败' };
  } catch (error) {
    return { success: false, error: '登录时发生错误' };
  } finally {
    setIsLoading(false);
  }
};
```

## 课程预订系统

网站实现了课程预订系统，具有以下功能：

- 课程查看：显示街舞社所有课程的时间表
- 课程预订：登录用户可以预订空闲时段的课程
- 预订取消：用户可以取消已预订的课程
- 预订管理：在个人主页查看和管理所有已预订课程

课程系统具有以下特点：

1. 显示课程详细信息，包括课程名称、教练、地点和时间
2. 实时更新课程预订状态和剩余名额
3. 显示用户已预订课程，并提供取消选项
4. 未登录用户会被提示登录后才能预订课程
5. 课程容量限制，超出容量的课程无法预订
6. 可查看各时间段和星期几的课程安排表格

### 课程预订API集成

```javascript
// API集成代码片段
export const fetchCourses = async (): Promise<Course[]> => {
  try {
    const response = await fetch(`${API_URL}/courses`, {
      headers: getAuthHeaders(),
    });
    
    if (!response.ok) {
      throw new Error('Failed to fetch courses');
    }
    
    return await response.json();
  } catch (error) {
    console.error('Error fetching courses:', error);
    throw error;
  }
};

export const bookCourse = async (courseId: string): Promise<void> => {
  try {
    const response = await fetch(`${API_URL}/courses/${courseId}/book`, {
      method: 'POST',
      headers: getAuthHeaders(),
    });
    
    if (!response.ok) {
      throw new Error('Failed to book course');
    }
  } catch (error) {
    console.error('Error booking course:', error);
    throw error;
  }
};
```

## 目录结构

```
├── public/               # 静态资源
│   ├── images/           # 图片资源说明文件（实际图片存储在腾讯云COS）
├── src/                  # 源代码
│   ├── app/              # 页面
│   │   ├── page.tsx      # 首页
│   │   ├── schedule/     # 课程表页面
│   │   ├── auth/         # 认证相关页面
│   │   │   ├── login/    # 登录页面
│   │   │   └── register/ # 注册页面
│   │   ├── user/         # 用户相关页面
│   │   │   └── profile/  # 用户个人信息页面
│   │   └── layout.tsx    # 全局布局
│   ├── components/       # 组件
│   │   ├── Navbar.tsx    # 导航栏
│   │   ├── Footer.tsx    # 页脚（含ICP备案信息）
│   │   ├── Hero.tsx      # 首页大图展示（带动画效果）
│   │   ├── About.tsx     # 关于我们部分（带滚动动画和16:9横版图片四宫格展示）
│   │   └── ScheduleTable.tsx # 课程表组件（含课程须知和管理规则）
│   ├── context/          # 上下文
│   │   └── AuthContext.tsx # 用户认证上下文
│   ├── services/         # 服务
│   │   └── api.ts        # API调用服务
│   └── types/            # 类型定义
│       └── index.ts      # 全局类型定义
```

## 自定义和扩展

可以通过修改以下文件进行自定义：

- `src/app/globals.css` - 全局样式，包含自定义滚动条
- `src/components/` - 各个组件的样式和功能
- 腾讯云COS中的图片资源
- `next.config.ts` - Next.js配置，包括图片域名设置等
- `src/components/Footer.tsx` - 页脚信息，包括备案信息
- `src/components/ScheduleTable.tsx` - 课程表和课程管理规则
- `src/components/Hero.tsx` - 首页滚动逻辑和动画效果
- `src/context/AuthContext.tsx` - 用户认证逻辑
- `src/services/api.ts` - API服务调用

## 后端API集成

为完成完整的功能，网站需要与后端API进行集成，实现以下接口：

1. 用户认证API：
   - `/api/auth/register` - 用户注册
   - `/api/auth/login` - 用户登录
   - `/api/auth/logout` - 用户登出
   - `/api/users/me` - 获取当前用户信息

2. 课程管理API：
   - `/api/courses` - 获取所有课程
   - `/api/courses/{id}` - 获取单个课程详情
   - `/api/courses/{id}/book` - 预订课程
   - `/api/courses/{id}/cancel` - 取消课程预订
   - `/api/users/bookings` - 获取当前用户的预订

这些API端点应由后端服务提供，并与前端集成以实现完整功能。

## 前后端连接故障排查指南

如果前端无法连接到后端API，可以按照以下步骤进行排查：

### 1. 检查后端服务器状态

确认后端服务器是否正在运行，以及是否在正确的端口上：

```bash
# Windows
netstat -ano | findstr "5000"

# Linux/macOS
lsof -i :5000
```

### 2. 检查前端API配置

确认`src/services/api.ts`中的API基础URL配置正确：

```typescript
// 使用相对路径，依赖Next.js的API路由转发
const API_BASE_URL = '/api';
```

同时确认`next.config.ts`中的API路由转发配置正确：

```typescript
async rewrites() {
  return [
    {
      source: '/api/:path*',
      destination: 'http://localhost:5000/api/:path*', // 后端API地址
    },
  ];
}
```

### 3. 检查网络连接和CORS

- 使用浏览器开发者工具检查网络请求，查看是否有CORS错误
- 确认后端服务器已正确配置CORS，允许前端域名的请求
- 检查请求和响应头，确保Content-Type正确

### 4. 使用工具直接测试API

使用Postman或curl等工具直接测试后端API：

```bash
curl http://localhost:5000/api/courses
```

### 5. 检查控制台错误

查看浏览器控制台和服务器日志，寻找更详细的错误信息。

### 6. 排查常见React警告

修复React组件中的key警告，确保渲染列表时每个元素都有唯一的key属性。

### 7. 增加调试日志

在API调用前后添加调试日志，跟踪请求发送和响应接收过程。

## 动画效果

项目中包含以下动画效果：

1. Hero组件入场动画：标题、描述和按钮的渐入和上移效果
2. 社徽悬停动画：鼠标悬停时的放大和光晕效果
3. 背景图片缓慢缩放：随页面滚动产生视差效果
4. About部分的滚动入场动画：使用Intersection Observer检测元素进入视口
5. 图片悬停效果：鼠标悬停时的放大和阴影效果
6. 特色部分的错落动画：三个特色卡片依次显示的动画效果
7. 平滑滚动：点击导航按钮时平滑滚动到相应部分

## 数据接入

课程表数据当前使用模拟数据，后期可以通过以下方式接入真实数据：

1. 在`src/components/ScheduleTable.tsx`中修改API调用
2. 实现数据获取函数，从后端获取课程安排
3. 添加数据刷新机制，保持课程表更新

## API集成

### API服务结构

项目使用模块化的API服务结构，主要包含以下几个模块：

```typescript
// 认证相关API
authApi.login(email, password)
authApi.register(username, email, password)
authApi.getCurrentUser()

// 课程相关API
courseApi.getAllCourses()
courseApi.getCourseById(courseId)
courseApi.getCourseBookingStatus(courseId)

// 预订相关API
bookingApi.getUserBookings()
bookingApi.bookCourse(courseId)
bookingApi.cancelBooking(courseId)
bookingApi.getCourseBookingStatus(courseId)
bookingApi.getBatchBookingStatus(courseIds)

// 用户相关API
userApi.updateProfile(userData)
userApi.changePassword(currentPassword, newPassword)
```

### 预订状态管理

课程预订状态遵循以下流程：

1. 用户登录时，系统自动加载所有课程的预订状态
2. 预订状态分为三种：
   - `not_booked`: 未预订
   - `confirmed`: 已确认预订
   - `canceled`: 已取消预订
3. 用户预订或取消课程后，系统会自动更新对应课程的预订状态
4. 使用API `bookingApi.getBatchBookingStatus()` 可批量获取多个课程的预订状态，提高性能

### 后端API端点

系统与以下主要API端点交互：

- `/api/auth/login` - 用户登录
- `/api/auth/register` - 用户注册
- `/api/users/me` - 获取当前用户信息
- `/api/courses` - 获取所有课程
- `/api/bookings/user` - 获取用户的预订
- `/api/bookings/{courseId}` - 预订或取消课程
- `/api/users/booking-status/{courseId}` - 获取指定课程的预订状态

这些API端点应由后端服务提供，并与前端集成以实现完整功能。

## 课程管理规则

- 课程预订开放时间为每周日晚上8点至次周日晚上8点
- 每人每周最多可预订3节课程
- 如需取消预订，请至少提前24小时操作
- 无故缺席已预订课程三次，将被限制预订权限一个月
- 请携带学生证或社团卡参加课程

## 自定义滚动容器

项目使用自定义滚动容器和滚动指示器，具体设置如下：

```css
:root {
  --scrollbar-width: 8px;
  --scrollbar-track-color: rgba(0, 0, 0, 0.05);
  --scrollbar-thumb-color: rgba(0, 0, 0, 0.3);
}

body {
  overflow: hidden;
  margin: 0;
  padding: 0;
  height: 100vh;
}

#scroll-container {
  height: 100vh;
  width: 100vw;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
  scroll-behavior: smooth;
}
```

滚动指示器通过 `ScrollIndicator` 组件实现，根据页面滚动位置动态显示当前位置标记。

## 更新日志

### 2025年4月21日 - 预约状态卡片显示优化

**问题：**
- 已预约课程卡片的视觉区分度不够明显，无法在整体课程表中快速识别
- 已预约状态的卡片配色与首页风格不统一
- 卡片内部文本与背景色对比度不足，影响可读性

**原因：**
- 已预约卡片只使用了淡黄色背景和黄色边框，与其他状态区分不明显
- 缺少强烈的视觉层次，无法突出重要的预约信息
- 文本颜色没有根据背景色调整，降低了内容可读性

**解决方案：**
1. 全面提升已预约卡片的视觉效果：
   - 将卡片背景色从淡黄色(bg-yellow-50)更改为正黄色(bg-yellow-500)
   - 所有文本更改为白色，提高在黄色背景上的可读性
   - 增加鼠标悬停效果，使用深黄色(hover:bg-yellow-600)增强交互体验

2. 强化信息层次和标签样式：
   - 舞种标签在已预约卡片中使用白底黄字样式，形成反差效果
   - 图标全部调整为白色，与文本保持一致
   - 容量标签使用与卡片主体相同的配色，保持视觉统一

3. 状态图例更新：
   - 更新图例中已预约状态的颜色，与实际卡片一致
   - 使用饱和度更高的黄色，提高图例的可识别性

**优化效果：**
- 已预约课程在整体课程表中更加醒目，一目了然
- 信息层次更加清晰，重要内容阅读体验更佳
- 视觉效果与首页风格保持一致，提升整体应用的设计连贯性
- 提高用户对已预约课程的关注度，帮助用户快速找到自己已预约的课程

### 2025年4月20日 - 课程预约状态视觉优化

**问题：**
- "已取消"状态在视觉上不够明显，与未预约状态过于相似
- "已预约"状态的显示效果需要更强的视觉反馈以提高用户体验
- 状态展示样式不够一致和协调

**原因：**
- "已取消"状态使用灰色系，与未预约状态的区分度不够
- "已预约"状态的背景色和边框不够醒目
- 状态标签的内边距和样式缺少整体性设计

**解决方案：**
1. 改进"已取消"状态的视觉效果：
   - 将灰色系更换为蓝色系，增强与其他状态的区分度
   - 为已取消状态添加蓝色边框和淡蓝色背景
   - 图标颜色调整为对应的状态颜色，增强视觉效果

2. 增强"已预约"状态的显示效果：
   - 增加卡片阴影效果，提高视觉层级
   - 使用更饱和的黄色背景，使状态标签更加醒目
   - 添加边框，增强立体感和可读性

3. 统一状态标签样式：
   - 为状态标签添加统一的内边距和边框样式
   - 增加图标颜色的一致性，与状态颜色相匹配
   - 调整状态说明图例，与实际显示效果保持一致

**优化效果：**
- 用户可以更清晰地区分不同的预约状态
- 重要的"已预约"状态更加突出，提高用户信息获取效率
- 整体界面更加协调统一，视觉体验更加舒适
- 状态颜色更加符合直觉：黄色表示已预约，蓝色表示已取消，提高用户理解度

### 2025年4月19日 - 课程预约状态更新逻辑修复

**问题：**
- 重新预约课程后，状态未正确更新为"已预约"，导致可能重复调用预约API
- 取消预约后，状态被错误地更新为"未预约"而非"已取消"，使得用户界面显示不一致
- API调用失败时错误处理不完善，用户反馈不清晰
- `refreshSingleCourse`方法对预约状态的更新不够可靠

**原因：**
- 预约和取消预约操作后的状态更新逻辑存在设计缺陷
- 缺少对API返回值null/undefined的安全检查
- 错误信息没有足够的上下文，导致用户无法理解错误原因
- 缺少直接更新课程预约人数的逻辑，过度依赖刷新API

**解决方案：**
1. 完善状态更新逻辑：
   - 重新预约后，将状态正确设置为"已预约"(confirmed)
   - 取消预约后，将状态正确设置为"已取消"(canceled)而不是"未预约"(not_booked)
   - 添加"已取消"状态的UI显示

2. 增强错误处理能力：
   - 添加详细的控制台日志，方便开发者排查问题
   - 优化用户错误提示，提供更有上下文的信息
   - 增加对API返回值的空值检查，防止运行时错误

3. 改进课程信息更新机制：
   - 在预约或取消操作后直接更新课程的预约人数
   - 使用`courseApi.refreshCourseInfo`获取最新课程数据
   - 添加错误处理，确保即使刷新失败也不影响主要流程

**优化效果：**
- 预约状态显示更加一致，避免了重复操作
- 用户能够清晰区分"未预约"和"已取消"两种不同状态
- 错误提示更加明确，帮助用户理解操作失败的原因
- 预约人数变化即时反映在界面上，提高了用户体验

### 2025年4月18日 - 课程表预约按钮优化和功能修复

**问题：**
- 课程预约按钮样式不够明显，不像标准按钮
- "已预约"状态标签与"取消预约"按钮出现显示重叠
- API调用错误：`bookingApi.getBookingStatus` 不存在，应使用 `bookingApi.getCourseBookingStatus`

**原因：**
- 预约按钮样式采用了简单的文本链接风格，视觉上不够突出
- 在已预约状态下，同时显示了状态标签和操作按钮，导致界面冗余和重叠
- API调用名称与服务函数名称不匹配

**解决方案：**
1. 增强预约按钮的视觉表现：
   - 添加背景色、边框和阴影，使按钮更加突出
   - 为不同状态的按钮使用不同的色彩方案（黄色作为预约按钮，红色作为取消按钮）
   - 增加内边距和圆角，提升按钮的可点击性

2. 优化状态标签与按钮的显示逻辑：
   - 在有取消预约按钮时，不再显示冗余的"已预约"状态标签
   - 保持容量信息显示的一致性，确保用户能清晰了解课程的可用情况

3. 修复API调用错误：
   - 将`bookingApi.getBookingStatus`修正为`bookingApi.getCourseBookingStatus`，确保功能正常

**优化效果：**
- 预约按钮更加醒目，提高了用户交互体验
- 避免了UI元素冗余和重叠，界面更加整洁
- 修复了API调用错误，确保预约功能正常工作
- 整体用户界面更加专业和精致，提高了用户体验

### 2025年4月17日 - 课程表可视化体验增强

**问题：**
- 课程表主体区域顶部缺少足够的留白，视觉上不平衡
- 课程卡片中的预约交互按钮在某些情况下未能正确显示
- 课程表整体区域排版紧凑，缺少呼吸空间

**原因：**
- 课程表底部有留白区域，但顶部没有相应的留白，导致视觉不平衡
- 课程卡片布局中的按钮容器样式定义不充分，导致按钮显示异常
- 课程表元素之间的间距设置不合理，影响整体阅读体验

**解决方案：**
1. 添加顶部留白区域：
   - 在时间轴和每个星期列的顶部添加30px高度的留白
   - 为时间标签和网格线的定位添加相应的30px偏移量
   - 调整课程卡片定位计算方式，考虑顶部留白

2. 改进预约按钮的显示：
   - 重构按钮容器样式，确保按钮始终可见
   - 加强按钮文本与图标的对齐方式
   - 确保按钮事件处理器正确绑定

3. 优化整体排版：
   - 为课程表容器增加适当的外边距和内边距
   - 保持底部留白区域与顶部一致，达到视觉平衡
   - 调整课程表总高度，自动计入顶部和底部的留白区域

**优化效果：**
- 课程表顶部和底部有均衡的留白，视觉上更协调
- 预约按钮在所有情况下都能正确显示，交互体验更流畅
- 整体布局更加合理，空间分配更均匀，提升用户体验

### 2025年4月16日 - 课程表布局网格优化

**问题：**
- 课程表右侧存在异常的填充区域，导致页面显示不协调
- 使用flex布局时，列宽分配不均，导致某些列被过度拉伸
- 课程表在某些屏幕尺寸下出现不必要的水平滚动

**原因：**
- 课程表布局使用flex方式未能正确处理列宽，导致不均匀的宽度分配
- 将`flex-1`应用于列时，最后一列被过度拉伸，产生了右侧异常区域
- 缺少精确控制每列宽度的机制，导致布局不稳定

**解决方案：**
1. 采用CSS Grid布局替代Flex布局:
   - 使用`display: grid`创建表格式布局
   - 设置`grid-template-columns: 70px repeat(7, 1fr)`精确控制列宽
   - 时间轴固定70px宽度，其余7列平均分配可用空间

2. 优化元素结构:
   - 移除不必要的嵌套div和多余的宽度类
   - 统一每列的边框和内边距设置
   - 添加`.no-padding-right`类解决右侧溢出问题

3. 简化样式定义:
   - 直接在元素上应用边框样式，不依赖预定义类
   - 使用`last:border-r-0`确保最右列没有右边框

**优化效果：**
- 课程表右侧不再有异常的填充区域
- 所有星期列宽度均匀分布，布局更加协调
- 列宽自动适应屏幕大小，改善了响应式体验
- 整体表格结构更加清晰，视觉上更符合表格的直觉认知

### 2025年4月15日 - 课程表显示空间优化

**问题：**
- 课程表左右两侧存在不必要的留白空间，浪费了可用显示区域
- 部分课程卡片内容被截断，特别是预约按钮文本
- 列宽不足以完整显示课程信息，导致文本被挤压

**原因：**
- 课程表容器设置了左右边距（mx-0 sm:mx-4），限制了有效宽度
- 周几列宽度设置不足（w-32 md:w-40），无法容纳全部内容
- 元素缺少适当的弹性布局和溢出控制

**解决方案：**
1. 移除课程表容器的左右边距：
   - 删除`mx-0 sm:mx-4`边距设置
   - 让表格充分利用整个可用空间

2. 增加周几列宽度：
   - 将列宽从`w-32 md:w-40`调整为`w-40 md:w-48`
   - 最小宽度从140px增加到170px
   - 确保所有课程内容有足够的显示空间

3. 改进课程卡片内部布局：
   - 为按钮添加`whitespace-nowrap`防止文本换行
   - 为图标添加`flex-shrink-0`确保不会被压缩
   - 调整元素间距和弹性布局，确保内容对齐

4. 优化响应式布局：
   - 设置`.schedule-container`的`min-width: 100%`
   - 移除固定的`min-width: 1350px`限制
   - 确保在各种屏幕尺寸下都能适当显示

**优化效果：**
- 课程表完全填充可用空间，无多余留白
- 按钮文本完整显示，不再被截断
- 课程信息布局更加合理，内容清晰可读
- 整体用户体验更加连贯和专业

### 2025年4月14日 - 课程表组件最终优化

**问题：**
- 时间轴宽度过窄，导致时间数字显示不完整或挤压
- 课程表总宽度计算未考虑时间轴宽度，导致轻微溢出问题
- 预约按钮在某些情况下显示不完整

**原因：**
- 时间轴容器宽度固定为16px，不足以完整显示时间文本
- 课程表总宽度计算只考虑了周几列的宽度，未包含时间轴宽度
- 样式定义分散，导致样式覆盖和不一致问题

**解决方案：**
1. 增加时间轴宽度:
   - 将时间轴宽度从16px增加到24px
   - 调整时间标签的位置和样式，确保完整显示

2. 优化总体宽度计算:
   - 将课程表最小宽度从1270px调整为1350px
   - 确保所有内容（包括时间轴和所有周几列）都能完整显示

3. 重构样式定义:
   - 简化样式结构，减少嵌套和重复
   - 统一使用字符串形式定义样式，提高可维护性
   - 为各列添加合理的边框样式，提升视觉分隔效果

4. 优化预约按钮显示:
   - 确保按钮文本使用`whitespace-nowrap`防止换行
   - 调整按钮容器布局，适应不同尺寸的课程卡片

**优化效果：**
- 时间轴显示更加清晰，时间数字完整可见
- 整个课程表可以完整显示，无溢出问题
- 预约按钮在各种尺寸的课程卡片中都能正确显示
- 整体界面更加统一美观，视觉分隔更清晰

### 2025年4月13日 - 课程表布局结构优化

**问题：**
- 课程表宽度受到max-w-7xl限制，导致星期日内容溢出
- 课程表高度被固定值限制，无法自然向下延伸
- 课程卡片位置和尺寸不准确，特别是1小时课程显示不完整

**原因：**
- 布局使用了固定宽度容器，未考虑内容实际需要的空间
- 使用了固定高度而非自适应高度，限制了内容展示
- 课程卡片位置计算使用百分比，在不同容器尺寸下表现不一致

**解决方案：**
1. 移除宽度限制，改为自适应布局：
   - 去除max-w-7xl等宽度限制类
   - 将容器样式改为自动适应内容宽度
   - 添加最小宽度确保所有日期列都能完整显示

2. 改进高度计算方式：
   - 将固定高度改为根据内容自动计算
   - 使用CSS变量动态设置时间表的高度
   - 确保课程表可以自然向下延伸，不受父容器限制

3. 优化课程卡片定位：
   - 将基于百分比的定位改为基于像素的绝对定位
   - 为每30分钟的时间段分配固定的60px高度
   - 确保即使是1小时的课程也有足够的显示空间（最小高度110px）

4. 改进时间轴和网格线：
   - 使用固定像素间隔而非百分比定位时间标签
   - 为整点和半点应用不同的视觉样式
   - 确保网格线与时间标签精确对齐

**优化效果：**
- 完全解决了星期日溢出问题，所有日期列都能完整显示
- 课程表高度自动适应课程数量，可以自然向下延伸
- 课程卡片位置更加精确，不同长度的课程都能完整显示
- 整体布局更加合理，适应各种屏幕尺寸
- 用户体验显著提升，可以查看完整课程信息

### 2025年4月12日 - 课程表与课程卡片UI优化

**问题：**
- 课程表组件存在不必要的滚动条和溢出问题，影响用户体验
- 课程卡片信息展示不够清晰，视觉效果较差
- 移动端适配不佳，界面混乱
- 组件配色与网站主题不匹配，缺乏一致性
- 时间轴刻度不够明显，1小时课程卡片显示不完整

**原因：**
- 布局结构设计不合理，导致元素溢出
- 信息层级不分明，缺乏视觉引导
- 响应式布局实现不完善
- 颜色主题未与全站风格统一（黄色#F59E0B主题）
- 时间轴高度和课程卡片最小高度设置不合理

**解决方案：**
1. 重构课程表组件的布局结构：
   - 优化滚动区域，避免出现不必要的滚动条和溢出问题
   - 调整组件高度为固定值700px，提供足够空间显示课程
   - 使用更合理的Flex布局，优化元素排列
   - 增加课程卡片最小高度，保证信息完整显示

2. 美化课程卡片显示：
   - 将图标颜色更改为黄色系（#F59E0B），增强视觉一致性
   - 改进信息分组和间距，提高可读性
   - 优化容量显示，满员情况下使用红色高亮提示
   - 为课程描述添加分隔线，使结构更清晰
   - 确保操作按钮文本不会换行

3. 增强视觉体验：
   - 添加悬停效果增强交互反馈
   - 将星期标题背景改为黄色系，提高辨识度
   - 优化按钮样式，使用黄色作为主色调
   - 底部添加图例，帮助用户理解不同状态

4. 统一网站配色：
   - 将课程表和课程卡片的主色调调整为黄色（#F59E0B）
   - 预约、取消等按钮采用一致的黄色系设计
   - 课程状态标识采用黄色系标记
   - 同步更新图示和指示器的配色方案

5. 改进时间轴设计：
   - 区分整点和半点时间刻度，增加可读性
   - 为整点添加实线，半点添加虚线，提高视觉层次
   - 整点时间使用加粗字体，半点时间使用较小字体
   - 确保足够的时间刻度高度，使1小时课程卡片完整显示

**优化效果：**
- 视觉效果更加清晰美观，信息层次分明
- 响应式布局更加合理，移动端体验提升
- 课程信息更加直观，重要信息一目了然
- 整体界面更加专业和现代化，与网站整体风格保持一致
- 溢出问题得到解决，各种屏幕尺寸下显示正常
- 时间轴清晰可读，帮助用户更好地辨识课程时间

### 2025年4月10日 - 课程时间表示重构

**问题：**
- 当前课程表使用固定时间格式，无法灵活适应不同时间段的课程
- 时间显示方式不直观，用户难以快速识别课程时间分布
- 移动设备上的显示效果不佳，滑动体验较差

**原因：**
- 使用固定单元格的表格式布局限制了时间表示的灵活性
- 缺乏自适应的时间轴设计，无法直观反映课程时长
- 移动端优化不足，导致界面溢出和交互不便

**解决方案：**
1. 核心功能重构：
   - 重写课程表核心组件，采用基于时间轴的自适应布局
   - 修改课程表单，允许管理员和舞种领队设置任意时间
   - 添加自定义时间输入和预设时间选择功能

2. 课程卡片位置计算：
   - 实现课程卡片的相对布局定位，根据时间精确映射
   - 课程卡片高度根据时长自适应调整
   - 动态时间标记代替固定单元格

3. 移动端显示优化：
   - 实现水平滚动功能，优化移动设备浏览体验
   - 优化触摸交互，提升移动操作流畅度
   - 自适应信息展示，确保重要信息在各种屏幕尺寸下清晰可见

**改进效果：**
- 支持不规则课程时间，提高时间表示灵活性
- 更清晰展示每日时间分布，增强时间信息直观性
- 优化用户体验，提高信息显示效率

### 2025年4月7日 - 用户管理页面舞种更新问题修复

**问题：**
- 在用户管理页面，更改用户角色和舞种类型时，舞种类型无法正确传输到后端

**原因：**
- 前端API调用中使用了`danceType`字段，而后端接口需要的是`dance_type`字段
- 两个字段同时存在于User类型定义中，但API调用时使用了不一致的字段名

**解决方案：**
1. API层修复：
   - 更新`updateUserRole`方法，确保同时包含`dance_type`和`danceType`字段
   - 当接收到带有`danceType`的数据时，自动复制到`dance_type`字段

2. 用户管理页面修复：
   - 修改`handleUpdateUserRole`函数，确保在API调用中包含正确的字段名
   - 更新用户表格数据渲染逻辑，处理两种可能的字段名

3. 类型定义优化：
   - 更新`User`类型定义，包含两种字段名以确保兼容性
   - 为`updateUserRole`方法添加更灵活的参数类型

**改进效果：**
- 舞种类型现在可以正确更新并发送到后端
- 提高了前后端交互的兼容性和稳定性
- 用户界面显示更加一致，减少了混淆

### 2025年4月6日 - 舞种类型显示问题修复

**问题：**
- 团队管理界面中舞种类型名称显示不正确
- 领队用户无法看到准确的舞种名称

**原因：**
- 后端API返回的`danceType`字段与前端使用的`dance_type`字段不匹配
- 用户类型定义中缺少对新API字段的支持

**解决方案：**
1. 更新布局文件以正确处理两种可能的字段名
2. 修改`User`类型定义，添加`danceType`字段与后端API保持一致
3. 修改`AuthContext`确保在处理用户数据时能兼容两种字段格式

**改进效果：**
- 舞种类型名称现在显示正确
- 提高了前后端数据一致性
- 改进了用户体验，避免用户困惑

### 2025年4月5日 - 管理界面美化

- **界面视觉增强**: 
  - 添加渐变背景、阴影效果和边框美化管理界面
  - 引入图标提升导航项的可识别性
  - 改进标题和用户信息的展示方式
- **舞种领队导航优化**:
  - 添加功能性导航栏，包含课程管理和舞种信息
  - 保持与管理员界面的设计一致性
  - 优化移动端适配，提升响应式体验
- **导航交互改进**:
  - 添加导航项点击反馈和悬停效果
  - 优化当前页面的视觉指示
  - 底部添加版权信息增强专业感

### 2025年4月4日 - 用户菜单优化

- **角色化管理菜单**: 根据用户角色显示不同的管理选项
  - 管理员: 显示用户管理和课程管理选项
  - 领队: 只显示课程管理选项
  - 普通成员: 没有管理选项
- **简化用户体验**: 确保用户只看到与自己权限相关的功能入口
- **统一设计**: 桌面端和移动端菜单保持一致的管理选项显示逻辑

### 2025年4月3日 - 导航栏优化

- **精简导航栏**: 删除了导航栏中的舞种领队入口，简化了主导航结构
- **优化用户体验**: 用户现在可以通过其他方式访问舞种领队页面，减少导航栏中的选项数量
- **保留权限控制**: 领队用户仍可通过用户菜单访问所负责的舞种页面

### 2025年4月2日 - 用户认证优化

- **持久化登录状态**: 修复了页面刷新后需要重新登录的问题
- **增强错误处理**: 添加了详细的日志记录和多种格式的API响应处理
- **本地存储优化**: 改进用户信息和认证令牌的存储机制
- **定期令牌验证**: 添加定时检查确保长时间使用时认证有效
- **网络错误容错**: 当API暂时不可用时保持用户登录状态

### 2025年4月2日 - 舞种领队页面优化

- **简洁界面**: 移除了舞种领队页面的冗余导航栏，使界面更简洁直观
- **专注内容**: 让舞种领队能更专注于内容管理而非导航切换
- **改进用户体验**: 使领队管理界面操作更加流畅和集中

### 2025年3月31日 - 管理员用户管理完善

- **创建用户**: 添加创建新用户功能，管理员可直接添加不同角色的用户
- **编辑用户**: 支持编辑用户角色和舞种类型
- **删除用户**: 添加用户删除功能，包括确认对话框
- **错误处理**: 完善API响应处理和错误提示

## 用户角色与权限系统

系统实现了三级用户角色管理，各角色具有不同的权限和功能：

### 1. 超级管理员 (admin)

- 具有系统最高权限
- 可以查看所有用户信息
- 可以按角色筛选用户
- 无需预约课程，可直接参加所有课程
- 管理系统配置和核心功能

### 2. 舞种领队 (leader)

- 具有特定舞种的管理权限
- 每个领队负责一个舞种类型（如Breaking、Popping等）
- 无需预约课程，可直接参加所有课程
- 可查看和管理自己负责的舞种信息
- 可以在系统中作为舞种的官方代表

### 3. 普通社员 (member)

- 基础用户权限
- 可以预约和取消课程
- 查看自己已预约的课程
- 浏览所有公开课程和舞种领队信息

### 预约课程权限

- 仅普通社员可以预约和取消课程
- 超级管理员和舞种领队无需预约即可参加课程
- 当舞种领队和超级管理员尝试预约课程时，系统会给予相应提示

### 舞种领队管理

系统提供公开的舞种领队查询功能：

- `/leaders` - 查看所有舞种的领队信息
- `/leaders/{danceType}` - 查看特定舞种的领队信息

这些页面对所有用户（包括未登录用户）可见，方便社员了解各舞种负责人信息。

### 用户管理

管理页面仅超级管理员可访问：

- `/admin/users` - 查看和管理所有用户
- 可按角色（admin/leader/member）筛选用户

## 测试账号

系统预设了不同角色的测试账号：

1. 超级管理员：
   - 用户名：admin
   - 密码：admin123

2. 舞种领队（Breaking）：
   - 用户名：bboy_leader
   - 密码：leader123

3. 舞种领队（Popping）：
   - 用户名：popping_leader
   - 密码：leader123

4. 普通社员：
   - 用户名：member1
   - 密码：member123

## API文档

### 课程管理接口

#### 获取课程列表 (管理员和领队)
- **URL**: `/api/admin/courses`
- **方法**: `GET`
- **权限**: 管理员和舞种领队
- **返回格式**:
```json
{
  "success": true,
  "data": [
    {
      "id": "1",
      "name": "Breaking基础班",
      "instructor": "张领队",
      "location": "文化中心B201",
      "weekday": "星期一",
      "timeSlot": "18:00-19:30",
      "maxCapacity": 15,
      "bookedBy": ["1", "3"],
      "description": "Breaking舞蹈基础教学，适合零基础学员。",
      "danceType": "breaking",
      "leaderId": "2"
    }
  ]
}
```

#### 创建课程 (管理员和领队)
- **URL**: `/api/admin/courses`
- **方法**: `POST`
- **权限**: 管理员和舞种领队
- **请求参数**:
```json
{
  "name": "课程名称",
  "instructor": "教师名称",
  "location": "上课地点",
  "weekday": "星期几",
  "timeSlot": "时间段",
  "maxCapacity": 20,
  "description": "课程描述",
  "danceType": "舞种类型", 
  "leaderId": "1"
}
```
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "7",
    "name": "课程名称",
    "instructor": "教师名称",
    "location": "上课地点",
    "weekday": "星期几",
    "timeSlot": "时间段",
    "maxCapacity": 20,
    "bookedBy": [],
    "description": "课程描述",
    "danceType": "breaking",
    "leaderId": "2"
  },
  "message": "课程创建成功"
}
```

#### 更新课程信息 (管理员和领队)
- **URL**: `/api/admin/courses/{courseId}`
- **方法**: `PUT`
- **权限**: 管理员和舞种领队（领队仅能修改自己舞种的课程）
- **请求参数**: 同创建课程
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "更新后的课程名称",
    "instructor": "更新后的教师",
    "location": "更新后的地点",
    "weekday": "星期一",
    "timeSlot": "18:00-19:30",
    "maxCapacity": 20,
    "bookedBy": ["1", "3"],
    "description": "更新后的描述",
    "danceType": "breaking",
    "leaderId": "2"
  },
  "message": "课程更新成功"
}
```

#### 删除课程 (管理员和领队)
- **URL**: `/api/admin/courses/{courseId}`
- **方法**: `DELETE`
- **权限**: 管理员和舞种领队（领队仅能删除自己舞种的课程）
- **返回格式**:
```json
{
  "success": true,
  "message": "课程删除成功"
}
```

#### 获取课程分配情况 (仅管理员)
- **URL**: `/api/admin/courses/assignments`
- **方法**: `GET`
- **权限**: 仅管理员
- **返回格式**:
```json
{
  "success": true,
  "data": [
    {
      "leaderId": "2",
      "leaderName": "张领队",
      "danceType": "breaking",
      "courseCount": 2
    },
    {
      "danceType": "public",
      "courseCount": 1
    }
  ]
}
```

#### 分配课程归属 (仅管理员)
- **URL**: `/api/admin/courses/{courseId}/assign`
- **方法**: `PUT`
- **权限**: 仅管理员
- **请求参数**:
```json
{
  "danceType": "舞种类型",
  "leaderId": "1"  
}
```
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "Breaking基础班",
    "instructor": "张领队",
    "location": "文化中心B201",
    "weekday": "星期一",
    "timeSlot": "18:00-19:30",
    "maxCapacity": 15,
    "bookedBy": ["1", "3"],
    "description": "Breaking舞蹈基础教学，适合零基础学员。",
    "danceType": "popping",
    "leaderId": "3"
  },
  "message": "课程归属分配成功"
}
```

## 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建Pull Request

## 许可证

[MIT](https://choosealicense.com/licenses/mit/)

## 最近更新日志

### 2025年4月21日 - 预约状态卡片显示优化

**问题：**
- 已预约课程卡片的视觉区分度不够明显，无法在整体课程表中快速识别
- 已预约状态的卡片配色与首页风格不统一
- 卡片内部文本与背景色对比度不足，影响可读性

**原因：**
- 已预约卡片只使用了淡黄色背景和黄色边框，与其他状态区分不明显
- 缺少强烈的视觉层次，无法突出重要的预约信息
- 文本颜色没有根据背景色调整，降低了内容可读性

**解决方案：**
1. 全面提升已预约卡片的视觉效果：
   - 将卡片背景色从淡黄色(bg-yellow-50)更改为正黄色(bg-yellow-500)
   - 所有文本更改为白色，提高在黄色背景上的可读性
   - 增加鼠标悬停效果，使用深黄色(hover:bg-yellow-600)增强交互体验

2. 强化信息层次和标签样式：
   - 舞种标签在已预约卡片中使用白底黄字样式，形成反差效果
   - 图标全部调整为白色，与文本保持一致
   - 容量标签使用与卡片主体相同的配色，保持视觉统一

3. 状态图例更新：
   - 更新图例中已预约状态的颜色，与实际卡片一致
   - 使用饱和度更高的黄色，提高图例的可识别性

**优化效果：**
- 已预约课程在整体课程表中更加醒目，一目了然
- 信息层次更加清晰，重要内容阅读体验更佳
- 视觉效果与首页风格保持一致，提升整体应用的设计连贯性
- 提高用户对已预约课程的关注度，帮助用户快速找到自己已预约的课程

### 2025年4月20日 - 课程预约状态视觉优化

**问题：**
- "已取消"状态在视觉上不够明显，与未预约状态过于相似
- "已预约"状态的显示效果需要更强的视觉反馈以提高用户体验
- 状态展示样式不够一致和协调

**原因：**
- "已取消"状态使用灰色系，与未预约状态的区分度不够
- "已预约"状态的背景色和边框不够醒目
- 状态标签的内边距和样式缺少整体性设计

**解决方案：**
1. 改进"已取消"状态的视觉效果：
   - 将灰色系更换为蓝色系，增强与其他状态的区分度
   - 为已取消状态添加蓝色边框和淡蓝色背景
   - 图标颜色调整为对应的状态颜色，增强视觉效果

2. 增强"已预约"状态的显示效果：
   - 增加卡片阴影效果，提高视觉层级
   - 使用更饱和的黄色背景，使状态标签更加醒目
   - 添加边框，增强立体感和可读性

3. 统一状态标签样式：
   - 为状态标签添加统一的内边距和边框样式
   - 增加图标颜色的一致性，与状态颜色相匹配
   - 调整状态说明图例，与实际显示效果保持一致

**优化效果：**
- 用户可以更清晰地区分不同的预约状态
- 重要的"已预约"状态更加突出，提高用户信息获取效率
- 整体界面更加协调统一，视觉体验更加舒适
- 状态颜色更加符合直觉：黄色表示已预约，蓝色表示已取消，提高用户理解度

### 2025年4月19日 - 课程预约状态更新逻辑修复

**问题：**
- 重新预约课程后，状态未正确更新为"已预约"，导致可能重复调用预约API
- 取消预约后，状态被错误地更新为"未预约"而非"已取消"，使得用户界面显示不一致
- API调用失败时错误处理不完善，用户反馈不清晰
- `refreshSingleCourse`方法对预约状态的更新不够可靠

**原因：**
- 预约和取消预约操作后的状态更新逻辑存在设计缺陷
- 缺少对API返回值null/undefined的安全检查
- 错误信息没有足够的上下文，导致用户无法理解错误原因
- 缺少直接更新课程预约人数的逻辑，过度依赖刷新API

**解决方案：**
1. 完善状态更新逻辑：
   - 重新预约后，将状态正确设置为"已预约"(confirmed)
   - 取消预约后，将状态正确设置为"已取消"(canceled)而不是"未预约"(not_booked)
   - 添加"已取消"状态的UI显示

2. 增强错误处理能力：
   - 添加详细的控制台日志，方便开发者排查问题
   - 优化用户错误提示，提供更有上下文的信息
   - 增加对API返回值的空值检查，防止运行时错误

3. 改进课程信息更新机制：
   - 在预约或取消操作后直接更新课程的预约人数
   - 使用`courseApi.refreshCourseInfo`获取最新课程数据
   - 添加错误处理，确保即使刷新失败也不影响主要流程

**优化效果：**
- 预约状态显示更加一致，避免了重复操作
- 用户能够清晰区分"未预约"和"已取消"两种不同状态
- 错误提示更加明确，帮助用户理解操作失败的原因
- 预约人数变化即时反映在界面上，提高了用户体验

### 2025年4月18日 - 课程表预约按钮优化和功能修复

**问题：**
- 课程预约按钮样式不够明显，不像标准按钮
- "已预约"状态标签与"取消预约"按钮出现显示重叠
- API调用错误：`bookingApi.getBookingStatus` 不存在，应使用 `bookingApi.getCourseBookingStatus`

**原因：**
- 预约按钮样式采用了简单的文本链接风格，视觉上不够突出
- 在已预约状态下，同时显示了状态标签和操作按钮，导致界面冗余和重叠
- API调用名称与服务函数名称不匹配

**解决方案：**
1. 增强预约按钮的视觉表现：
   - 添加背景色、边框和阴影，使按钮更加突出
   - 为不同状态的按钮使用不同的色彩方案（黄色作为预约按钮，红色作为取消按钮）
   - 增加内边距和圆角，提升按钮的可点击性

2. 优化状态标签与按钮的显示逻辑：
   - 在有取消预约按钮时，不再显示冗余的"已预约"状态标签
   - 保持容量信息显示的一致性，确保用户能清晰了解课程的可用情况

3. 修复API调用错误：
   - 将`bookingApi.getBookingStatus`修正为`bookingApi.getCourseBookingStatus`，确保功能正常

**优化效果：**
- 预约按钮更加醒目，提高了用户交互体验
- 避免了UI元素冗余和重叠，界面更加整洁
- 修复了API调用错误，确保预约功能正常工作
- 整体用户界面更加专业和精致，提高了用户体验

### 2025年4月17日 - 课程表可视化体验增强

**问题：**
- 课程表主体区域顶部缺少足够的留白，视觉上不平衡
- 课程卡片中的预约交互按钮在某些情况下未能正确显示
- 课程表整体区域排版紧凑，缺少呼吸空间

**原因：**
- 课程表底部有留白区域，但顶部没有相应的留白，导致视觉不平衡
- 课程卡片布局中的按钮容器样式定义不充分，导致按钮显示异常
- 课程表元素之间的间距设置不合理，影响整体阅读体验

**解决方案：**
1. 添加顶部留白区域：
   - 在时间轴和每个星期列的顶部添加30px高度的留白
   - 为时间标签和网格线的定位添加相应的30px偏移量
   - 调整课程卡片定位计算方式，考虑顶部留白

2. 改进预约按钮的显示：
   - 重构按钮容器样式，确保按钮始终可见
   - 加强按钮文本与图标的对齐方式
   - 确保按钮事件处理器正确绑定

3. 优化整体排版：
   - 为课程表容器增加适当的外边距和内边距
   - 保持底部留白区域与顶部一致，达到视觉平衡
   - 调整课程表总高度，自动计入顶部和底部的留白区域

**优化效果：**
- 课程表顶部和底部有均衡的留白，视觉上更协调
- 预约按钮在所有情况下都能正确显示，交互体验更流畅
- 整体布局更加合理，空间分配更均匀，提升用户体验

### 2025年4月16日 - 课程表布局网格优化

**问题：**
- 课程表右侧存在异常的填充区域，导致页面显示不协调
- 使用flex布局时，列宽分配不均，导致某些列被过度拉伸
- 课程表在某些屏幕尺寸下出现不必要的水平滚动

**原因：**
- 课程表布局使用flex方式未能正确处理列宽，导致不均匀的宽度分配
- 将`flex-1`应用于列时，最后一列被过度拉伸，产生了右侧异常区域
- 缺少精确控制每列宽度的机制，导致布局不稳定

**解决方案：**
1. 采用CSS Grid布局替代Flex布局:
   - 使用`display: grid`创建表格式布局
   - 设置`grid-template-columns: 70px repeat(7, 1fr)`精确控制列宽
   - 时间轴固定70px宽度，其余7列平均分配可用空间

2. 优化元素结构:
   - 移除不必要的嵌套div和多余的宽度类
   - 统一每列的边框和内边距设置
   - 添加`.no-padding-right`类解决右侧溢出问题

3. 简化样式定义:
   - 直接在元素上应用边框样式，不依赖预定义类
   - 使用`last:border-r-0`确保最右列没有右边框

**优化效果：**
- 课程表右侧不再有异常的填充区域
- 所有星期列宽度均匀分布，布局更加协调
- 列宽自动适应屏幕大小，改善了响应式体验
- 整体表格结构更加清晰，视觉上更符合表格的直觉认知

### 2025年4月15日 - 课程表显示空间优化

**问题：**
- 课程表左右两侧存在不必要的留白空间，浪费了可用显示区域
- 部分课程卡片内容被截断，特别是预约按钮文本
- 列宽不足以完整显示课程信息，导致文本被挤压

**原因：**
- 课程表容器设置了左右边距（mx-0 sm:mx-4），限制了有效宽度
- 周几列宽度设置不足（w-32 md:w-40），无法容纳全部内容
- 元素缺少适当的弹性布局和溢出控制

**解决方案：**
1. 移除课程表容器的左右边距：
   - 删除`mx-0 sm:mx-4`边距设置
   - 让表格充分利用整个可用空间

2. 增加周几列宽度：
   - 将列宽从`w-32 md:w-40`调整为`w-40 md:w-48`
   - 最小宽度从140px增加到170px
   - 确保所有课程内容有足够的显示空间

3. 改进课程卡片内部布局：
   - 为按钮添加`whitespace-nowrap`防止文本换行
   - 为图标添加`flex-shrink-0`确保不会被压缩
   - 调整元素间距和弹性布局，确保内容对齐

4. 优化响应式布局：
   - 设置`.schedule-container`的`min-width: 100%`
   - 移除固定的`min-width: 1350px`限制
   - 确保在各种屏幕尺寸下都能适当显示

**优化效果：**
- 课程表完全填充可用空间，无多余留白
- 按钮文本完整显示，不再被截断
- 课程信息布局更加合理，内容清晰可读
- 整体用户体验更加连贯和专业

### 2025年4月14日 - 课程表组件最终优化

**问题：**
- 时间轴宽度过窄，导致时间数字显示不完整或挤压
- 课程表总宽度计算未考虑时间轴宽度，导致轻微溢出问题
- 预约按钮在某些情况下显示不完整

**原因：**
- 时间轴容器宽度固定为16px，不足以完整显示时间文本
- 课程表总宽度计算只考虑了周几列的宽度，未包含时间轴宽度
- 样式定义分散，导致样式覆盖和不一致问题

**解决方案：**
1. 增加时间轴宽度:
   - 将时间轴宽度从16px增加到24px
   - 调整时间标签的位置和样式，确保完整显示

2. 优化总体宽度计算:
   - 将课程表最小宽度从1270px调整为1350px
   - 确保所有内容（包括时间轴和所有周几列）都能完整显示

3. 重构样式定义:
   - 简化样式结构，减少嵌套和重复
   - 统一使用字符串形式定义样式，提高可维护性
   - 为各列添加合理的边框样式，提升视觉分隔效果

4. 优化预约按钮显示:
   - 确保按钮文本使用`whitespace-nowrap`防止换行
   - 调整按钮容器布局，适应不同尺寸的课程卡片

**优化效果：**
- 时间轴显示更加清晰，时间数字完整可见
- 整个课程表可以完整显示，无溢出问题
- 预约按钮在各种尺寸的课程卡片中都能正确显示
- 整体界面更加统一美观，视觉分隔更清晰

### 2025年4月13日 - 课程表布局结构优化

**问题：**
- 课程表宽度受到max-w-7xl限制，导致星期日内容溢出
- 课程表高度被固定值限制，无法自然向下延伸
- 课程卡片位置和尺寸不准确，特别是1小时课程显示不完整

**原因：**
- 布局使用了固定宽度容器，未考虑内容实际需要的空间
- 使用了固定高度而非自适应高度，限制了内容展示
- 课程卡片位置计算使用百分比，在不同容器尺寸下表现不一致

**解决方案：**
1. 移除宽度限制，改为自适应布局：
   - 去除max-w-7xl等宽度限制类
   - 将容器样式改为自动适应内容宽度
   - 添加最小宽度确保所有日期列都能完整显示

2. 改进高度计算方式：
   - 将固定高度改为根据内容自动计算
   - 使用CSS变量动态设置时间表的高度
   - 确保课程表可以自然向下延伸，不受父容器限制

3. 优化课程卡片定位：
   - 将基于百分比的定位改为基于像素的绝对定位
   - 为每30分钟的时间段分配固定的60px高度
   - 确保即使是1小时的课程也有足够的显示空间（最小高度110px）

4. 改进时间轴和网格线：
   - 使用固定像素间隔而非百分比定位时间标签
   - 为整点和半点应用不同的视觉样式
   - 确保网格线与时间标签精确对齐

**优化效果：**
- 完全解决了星期日溢出问题，所有日期列都能完整显示
- 课程表高度自动适应课程数量，可以自然向下延伸
- 课程卡片位置更加精确，不同长度的课程都能完整显示
- 整体布局更加合理，适应各种屏幕尺寸
- 用户体验显著提升，可以查看完整课程信息

### 2025年4月12日 - 课程表与课程卡片UI优化

**问题：**
- 课程表组件存在不必要的滚动条和溢出问题，影响用户体验
- 课程卡片信息展示不够清晰，视觉效果较差
- 移动端适配不佳，界面混乱
- 组件配色与网站主题不匹配，缺乏一致性
- 时间轴刻度不够明显，1小时课程卡片显示不完整

**原因：**
- 布局结构设计不合理，导致元素溢出
- 信息层级不分明，缺乏视觉引导
- 响应式布局实现不完善
- 颜色主题未与全站风格统一（黄色#F59E0B主题）
- 时间轴高度和课程卡片最小高度设置不合理

**解决方案：**
1. 重构课程表组件的布局结构：
   - 优化滚动区域，避免出现不必要的滚动条和溢出问题
   - 调整组件高度为固定值700px，提供足够空间显示课程
   - 使用更合理的Flex布局，优化元素排列
   - 增加课程卡片最小高度，保证信息完整显示

2. 美化课程卡片显示：
   - 将图标颜色更改为黄色系（#F59E0B），增强视觉一致性
   - 改进信息分组和间距，提高可读性
   - 优化容量显示，满员情况下使用红色高亮提示
   - 为课程描述添加分隔线，使结构更清晰
   - 确保操作按钮文本不会换行

3. 增强视觉体验：
   - 添加悬停效果增强交互反馈
   - 将星期标题背景改为黄色系，提高辨识度
   - 优化按钮样式，使用黄色作为主色调
   - 底部添加图例，帮助用户理解不同状态

4. 统一网站配色：
   - 将课程表和课程卡片的主色调调整为黄色（#F59E0B）
   - 预约、取消等按钮采用一致的黄色系设计
   - 课程状态标识采用黄色系标记
   - 同步更新图示和指示器的配色方案

5. 改进时间轴设计：
   - 区分整点和半点时间刻度，增加可读性
   - 为整点添加实线，半点添加虚线，提高视觉层次
   - 整点时间使用加粗字体，半点时间使用较小字体
   - 确保足够的时间刻度高度，使1小时课程卡片完整显示

**优化效果：**
- 视觉效果更加清晰美观，信息层次分明
- 响应式布局更加合理，移动端体验提升
- 课程信息更加直观，重要信息一目了然
- 整体界面更加专业和现代化，与网站整体风格保持一致
- 溢出问题得到解决，各种屏幕尺寸下显示正常
- 时间轴清晰可读，帮助用户更好地辨识课程时间

### 2025年4月10日 - 课程时间表示重构

**问题：**
- 当前课程表使用固定时间格式，无法灵活适应不同时间段的课程
- 时间显示方式不直观，用户难以快速识别课程时间分布
- 移动设备上的显示效果不佳，滑动体验较差

**原因：**
- 使用固定单元格的表格式布局限制了时间表示的灵活性
- 缺乏自适应的时间轴设计，无法直观反映课程时长
- 移动端优化不足，导致界面溢出和交互不便

**解决方案：**
1. 核心功能重构：
   - 重写课程表核心组件，采用基于时间轴的自适应布局
   - 修改课程表单，允许管理员和舞种领队设置任意时间
   - 添加自定义时间输入和预设时间选择功能

2. 课程卡片位置计算：
   - 实现课程卡片的相对布局定位，根据时间精确映射
   - 课程卡片高度根据时长自适应调整
   - 动态时间标记代替固定单元格

3. 移动端显示优化：
   - 实现水平滚动功能，优化移动设备浏览体验
   - 优化触摸交互，提升移动操作流畅度
   - 自适应信息展示，确保重要信息在各种屏幕尺寸下清晰可见

**改进效果：**
- 支持不规则课程时间，提高时间表示灵活性
- 更清晰展示每日时间分布，增强时间信息直观性
- 优化用户体验，提高信息显示效率

### 2025年4月7日 - 用户管理页面舞种更新问题修复

**问题：**
- 在用户管理页面，更改用户角色和舞种类型时，舞种类型无法正确传输到后端

**原因：**
- 前端API调用中使用了`danceType`字段，而后端接口需要的是`dance_type`字段
- 两个字段同时存在于User类型定义中，但API调用时使用了不一致的字段名

**解决方案：**
1. API层修复：
   - 更新`updateUserRole`方法，确保同时包含`dance_type`和`danceType`字段
   - 当接收到带有`danceType`的数据时，自动复制到`dance_type`字段

2. 用户管理页面修复：
   - 修改`handleUpdateUserRole`函数，确保在API调用中包含正确的字段名
   - 更新用户表格数据渲染逻辑，处理两种可能的字段名

3. 类型定义优化：
   - 更新`User`类型定义，包含两种字段名以确保兼容性
   - 为`updateUserRole`方法添加更灵活的参数类型

**改进效果：**
- 舞种类型现在可以正确更新并发送到后端
- 提高了前后端交互的兼容性和稳定性
- 用户界面显示更加一致，减少了混淆

### 2025年4月6日 - 舞种类型显示问题修复

**问题：**
- 团队管理界面中舞种类型名称显示不正确
- 领队用户无法看到准确的舞种名称

**原因：**
- 后端API返回的`danceType`字段与前端使用的`dance_type`字段不匹配
- 用户类型定义中缺少对新API字段的支持

**解决方案：**
1. 更新布局文件以正确处理两种可能的字段名
2. 修改`User`类型定义，添加`danceType`字段与后端API保持一致
3. 修改`AuthContext`确保在处理用户数据时能兼容两种字段格式

**改进效果：**
- 舞种类型名称现在显示正确
- 提高了前后端数据一致性
- 改进了用户体验，避免用户困惑

### 2025年4月5日 - 管理界面美化

- **界面视觉增强**: 
  - 添加渐变背景、阴影效果和边框美化管理界面
  - 引入图标提升导航项的可识别性
  - 改进标题和用户信息的展示方式
- **舞种领队导航优化**:
  - 添加功能性导航栏，包含课程管理和舞种信息
  - 保持与管理员界面的设计一致性
  - 优化移动端适配，提升响应式体验
- **导航交互改进**:
  - 添加导航项点击反馈和悬停效果
  - 优化当前页面的视觉指示
  - 底部添加版权信息增强专业感

### 2025年4月4日 - 用户菜单优化

- **角色化管理菜单**: 根据用户角色显示不同的管理选项
  - 管理员: 显示用户管理和课程管理选项
  - 领队: 只显示课程管理选项
  - 普通成员: 没有管理选项
- **简化用户体验**: 确保用户只看到与自己权限相关的功能入口
- **统一设计**: 桌面端和移动端菜单保持一致的管理选项显示逻辑

### 2025年4月3日 - 导航栏优化

- **精简导航栏**: 删除了导航栏中的舞种领队入口，简化了主导航结构
- **优化用户体验**: 用户现在可以通过其他方式访问舞种领队页面，减少导航栏中的选项数量
- **保留权限控制**: 领队用户仍可通过用户菜单访问所负责的舞种页面

### 2025年4月2日 - 用户认证优化

- **持久化登录状态**: 修复了页面刷新后需要重新登录的问题
- **增强错误处理**: 添加了详细的日志记录和多种格式的API响应处理
- **本地存储优化**: 改进用户信息和认证令牌的存储机制
- **定期令牌验证**: 添加定时检查确保长时间使用时认证有效
- **网络错误容错**: 当API暂时不可用时保持用户登录状态

### 2025年4月2日 - 舞种领队页面优化

- **简洁界面**: 移除了舞种领队页面的冗余导航栏，使界面更简洁直观
- **专注内容**: 让舞种领队能更专注于内容管理而非导航切换
- **改进用户体验**: 使领队管理界面操作更加流畅和集中

### 2025年3月31日 - 管理员用户管理完善

- **创建用户**: 添加创建新用户功能，管理员可直接添加不同角色的用户
- **编辑用户**: 支持编辑用户角色和舞种类型
- **删除用户**: 添加用户删除功能，包括确认对话框
- **错误处理**: 完善API响应处理和错误提示

## 用户角色与权限系统

系统实现了三级用户角色管理，各角色具有不同的权限和功能：

### 1. 超级管理员 (admin)

- 具有系统最高权限
- 可以查看所有用户信息
- 可以按角色筛选用户
- 无需预约课程，可直接参加所有课程
- 管理系统配置和核心功能

### 2. 舞种领队 (leader)

- 具有特定舞种的管理权限
- 每个领队负责一个舞种类型（如Breaking、Popping等）
- 无需预约课程，可直接参加所有课程
- 可查看和管理自己负责的舞种信息
- 可以在系统中作为舞种的官方代表

### 3. 普通社员 (member)

- 基础用户权限
- 可以预约和取消课程
- 查看自己已预约的课程
- 浏览所有公开课程和舞种领队信息

### 预约课程权限

- 仅普通社员可以预约和取消课程
- 超级管理员和舞种领队无需预约即可参加课程
- 当舞种领队和超级管理员尝试预约课程时，系统会给予相应提示

### 舞种领队管理

系统提供公开的舞种领队查询功能：

- `/leaders` - 查看所有舞种的领队信息
- `/leaders/{danceType}` - 查看特定舞种的领队信息

这些页面对所有用户（包括未登录用户）可见，方便社员了解各舞种负责人信息。

### 用户管理

管理页面仅超级管理员可访问：

- `/admin/users` - 查看和管理所有用户
- 可按角色（admin/leader/member）筛选用户

## 测试账号

系统预设了不同角色的测试账号：

1. 超级管理员：
   - 用户名：admin
   - 密码：admin123

2. 舞种领队（Breaking）：
   - 用户名：bboy_leader
   - 密码：leader123

3. 舞种领队（Popping）：
   - 用户名：popping_leader
   - 密码：leader123

4. 普通社员：
   - 用户名：member1
   - 密码：member123

## API文档

### 课程管理接口

#### 获取课程列表 (管理员和领队)
- **URL**: `/api/admin/courses`
- **方法**: `GET`
- **权限**: 管理员和舞种领队
- **返回格式**:
```json
{
  "success": true,
  "data": [
    {
      "id": "1",
      "name": "Breaking基础班",
      "instructor": "张领队",
      "location": "文化中心B201",
      "weekday": "星期一",
      "timeSlot": "18:00-19:30",
      "maxCapacity": 15,
      "bookedBy": ["1", "3"],
      "description": "Breaking舞蹈基础教学，适合零基础学员。",
      "danceType": "breaking",
      "leaderId": "2"
    }
  ]
}
```

#### 创建课程 (管理员和领队)
- **URL**: `/api/admin/courses`
- **方法**: `POST`
- **权限**: 管理员和舞种领队
- **请求参数**:
```json
{
  "name": "课程名称",
  "instructor": "教师名称",
  "location": "上课地点",
  "weekday": "星期几",
  "timeSlot": "时间段",
  "maxCapacity": 20,
  "description": "课程描述",
  "danceType": "舞种类型", 
  "leaderId": "1"
}
```
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "7",
    "name": "课程名称",
    "instructor": "教师名称",
    "location": "上课地点",
    "weekday": "星期几",
    "timeSlot": "时间段",
    "maxCapacity": 20,
    "bookedBy": [],
    "description": "课程描述",
    "danceType": "breaking",
    "leaderId": "2"
  },
  "message": "课程创建成功"
}
```

#### 更新课程信息 (管理员和领队)
- **URL**: `/api/admin/courses/{courseId}`
- **方法**: `PUT`
- **权限**: 管理员和舞种领队（领队仅能修改自己舞种的课程）
- **请求参数**: 同创建课程
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "更新后的课程名称",
    "instructor": "更新后的教师",
    "location": "更新后的地点",
    "weekday": "星期一",
    "timeSlot": "18:00-19:30",
    "maxCapacity": 20,
    "bookedBy": ["1", "3"],
    "description": "更新后的描述",
    "danceType": "breaking",
    "leaderId": "2"
  },
  "message": "课程更新成功"
}
```

#### 删除课程 (管理员和领队)
- **URL**: `/api/admin/courses/{courseId}`
- **方法**: `DELETE`
- **权限**: 管理员和舞种领队（领队仅能删除自己舞种的课程）
- **返回格式**:
```json
{
  "success": true,
  "message": "课程删除成功"
}
```

#### 获取课程分配情况 (仅管理员)
- **URL**: `/api/admin/courses/assignments`
- **方法**: `GET`
- **权限**: 仅管理员
- **返回格式**:
```json
{
  "success": true,
  "data": [
    {
      "leaderId": "2",
      "leaderName": "张领队",
      "danceType": "breaking",
      "courseCount": 2
    },
    {
      "danceType": "public",
      "courseCount": 1
    }
  ]
}
```

#### 分配课程归属 (仅管理员)
- **URL**: `/api/admin/courses/{courseId}/assign`
- **方法**: `PUT`
- **权限**: 仅管理员
- **请求参数**:
```json
{
  "danceType": "舞种类型",
  "leaderId": "1"  
}
```
- **返回格式**:
```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "Breaking基础班",
    "instructor": "张领队",
    "location": "文化中心B201",
    "weekday": "星期一",
    "timeSlot": "18:00-19:30",
    "maxCapacity": 15,
    "bookedBy": ["1", "3"],
    "description": "Breaking舞蹈基础教学，适合零基础学员。",
    "danceType": "popping",
    "leaderId": "3"
  },
  "message": "课程归属分配成功"
}
```

## 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建Pull Request

## 许可证

[MIT](https://choosealicense.com/licenses/mit/)

## 最近更新日志

### 2025年4月21日 - 预约状态卡片显示优化

**问题：**
- 已预约课程卡片的视觉区分度不够明显，无法在整体课程表中快速识别
- 已预约状态的卡片配色与首页风格不统一
- 卡片内部文本与背景色对比度不足，影响可读性

**原因：**
- 已预约卡片只使用了淡黄色背景和黄色边框，与其他状态区分不明显
- 缺少强烈的视觉层次，无法突出重要的预约信息
- 文本颜色没有根据背景色调整，降低了内容可读性

**解决方案：**
1. 全面提升已预约卡片的视觉效果：
   - 将卡片背景色从淡黄色(bg-yellow-50)更改为正黄色(bg-yellow-500)
   - 所有文本更改为白色，提高在黄色背景上的可读性
   - 增加鼠标悬停效果，使用深黄色(hover:bg-yellow-600)增强交互体验

2. 强化信息层次和标签样式：
   - 舞种标签在已预约卡片中使用白底黄字样式，形成反差效果
   - 图标全部调整为白色，与文本保持一致
   - 容量标签使用与卡片主体相同的配色，保持视觉统一

3. 状态图例更新：
   - 更新图例中已预约状态的颜色，与实际卡片一致
   - 使用饱和度更高的黄色，提高图例的可识别性

**优化效果：**
- 已预约课程在整体课程表中更加醒目，一目了然
- 信息层次更加清晰，重要内容阅读体验更佳
- 视觉效果与首页风格保持一致，提升整体应用的设计连贯性
- 提高用户对已预约课程的关注度，帮助用户快速找到自己已预约的课程

### 2025年4月20日 - 课程预约状态视觉优化

**问题：**
- "已取消"状态在视觉上不够明显，与未预约状态过于相似
- "已预约"状态的显示效果需要更强的视觉反馈以提高用户体验
- 状态展示样式不够一致和协调

**原因：**
- "已取消"状态使用灰色系，与未预约状态的区分度不够
- "已预约"状态的背景色和边框不够醒目
- 状态标签的内边距和样式缺少整体性设计

**解决方案：**
1. 改进"已取消"状态的视觉效果：
   - 将灰色系更换为蓝色系，增强与其他状态的区分度
   - 为已取消状态添加蓝色边框和淡蓝色背景
   - 图标颜色调整为对应的状态颜色，增强视觉效果

2. 增强"已预约"状态的显示效果：
   - 增加卡片阴影效果，提高视觉层级
   - 使用更饱和的黄色背景，使状态标签更加醒目
   - 添加边框，增强立体感和可读性

3. 统一状态标签样式：
   - 为状态标签添加统一的内边距和边框样式
   - 增加图标颜色的一致性，与状态颜色相匹配
   - 调整状态说明图例，与实际显示效果保持一致

**优化效果：**
- 用户可以更清晰地区分不同的预约状态
- 重要的"已预约"状态更加突出，提高用户信息获取效率
- 整体界面更加协调统一，视觉体验更加舒适
- 状态颜色更加符合直觉：黄色表示已预约，蓝色表示已取消，提高用户理解度

### 2025年4月19日 - 课程预约状态更新逻辑修复

**问题：**
- 重新预约课程后，状态未正确更新为"已预约"，导致可能重复调用预约API
- 取消预约后，状态被错误地更新为"未预约"而非"已取消"，使得用户界面显示不一致
- API调用失败时错误处理不完善，用户反馈不清晰
- `refreshSingleCourse`方法对预约状态的更新不够可靠

**原因：**
- 预约和取消预约操作后的状态更新逻辑存在设计缺陷
- 缺少对API返回值null/undefined的安全检查
- 错误信息没有足够的上下文，导致用户无法理解错误原因
- 缺少直接更新课程预约人数的逻辑，过度依赖刷新API

**解决方案：**
1. 完善状态更新逻辑：
   - 重新预约后，将状态正确设置为"已预约"(confirmed)
   - 取消预约后，将状态正确设置为"已取消"(canceled)而不是"未预约"(not_booked)
   - 添加"已取消"状态的UI显示

2. 增强错误处理能力：
   - 添加详细的控制台日志，方便开发者排查问题
   - 优化用户错误提示，提供更有上下文的信息
   - 增加对API返回值的空值检查，防止运行时错误

3. 改进课程信息更新机制：
   - 在预约或取消操作后直接更新课程的预约人数
   - 使用`courseApi.refreshCourseInfo`获取最新课程数据
   - 添加错误处理，确保即使刷新失败也不影响主要流程

**优化效果：**
- 预约状态显示更加一致，避免了重复操作
- 用户能够清晰区分"未预约"和"已取消"两种不同状态
- 错误提示更加明确，帮助用户理解操作失败的原因
- 预约人数变化即时反映在界面上，提高了用户体验

### 2025年4月18日 - 课程表预约按钮优化和功能修复

**问题：**
- 课程预约按钮样式不够明显，不像标准按钮
- "已预约"状态标签与"取消预约"按钮出现显示重叠
- API调用错误：`bookingApi.getBookingStatus` 不存在，应使用 `bookingApi.getCourseBookingStatus`

**原因：**
- 预约按钮样式采用了简单的文本链接风格，视觉上不够突出
- 在已预约状态下，同时显示了状态标签和操作按钮，导致界面冗余和重叠
- API调用名称与服务函数名称不匹配

**解决方案：**
1. 增强预约按钮的视觉表现：
   - 添加背景色、边框和阴影，使按钮更加突出
   - 为不同状态的按钮使用不同的色彩方案（黄色作为预约按钮，红色作为取消按钮）
   - 增加内边距和圆角，提升按钮的可点击性

2. 优化状态标签与按钮的显示逻辑：
   - 在有取消预约按钮时，不再显示冗余的"已预约"状态标签
   - 保持容量信息显示的一致性，确保用户能清晰了解课程的可用情况

3. 修复API调用错误：
   - 将`bookingApi.getBookingStatus`修正为`bookingApi.getCourseBookingStatus`，确保功能正常

**优化效果：**
- 预约按钮更加醒目，提高了用户交互体验
- 避免了UI元素冗余和重叠，界面更加整洁
- 修复了API调用错误，确保预约功能正常工作
- 整体用户界面更加专业和精致，提高了用户体验

### 2025年4月17日 - 课程表可视化体验增强

**问题：**
- 课程表主体区域顶部缺少足够的留白，视觉上不平衡
- 课程卡片中的预约交互按钮在某些情况下未能正确显示
- 课程表整体区域排版紧凑，缺少呼吸空间

**原因：**
- 课程表底部有留白区域，但顶部没有相应的留白，导致视觉不平衡
- 课程卡片布局中的按钮容器样式定义不充分，导致按钮显示异常
- 课程表元素之间的间距设置不合理，影响整体阅读体验

**解决方案：**
1. 添加顶部留白区域：
   - 在时间轴和每个星期列的顶部添加30px高度的留白
   - 为时间标签和网格线的定位添加相应的30px偏移量
   - 调整课程卡片定位计算方式，考虑顶部留白

2. 改进预约按钮的显示：
   - 重构按钮容器样式，确保按钮始终可见
   - 加强按钮文本与图标的对齐方式
   - 确保按钮事件处理器正确绑定

3. 优化整体排版：
   - 为课程表容器增加适当的外边距和内边距
   - 保持底部留白区域与顶部一致，达到视觉平衡
   - 调整课程表总高度，自动计入顶部和底部的留白区域

**优化效果：**
- 课程表顶部和底部有均衡的留白，视觉上更协调
- 预约按钮在所有情况下都能正确显示，交互体验更流畅
- 整体布局更加合理，空间分配更均匀，提升用户体验

### 2025年4月16日 - 课程表布局网格优化

**问题：**
- 课程表右侧存在异常的填充区域，导致页面显示不协调
- 使用flex布局时，列宽分配不均，导致某些列被过度拉伸
- 课程表在某些屏幕尺寸下出现不必要的水平滚动

**原因：**
- 课程表布局使用flex方式未能正确处理列宽，导致不均匀的宽度分配
- 将`flex-1`应用于列时，最后一列被过度拉伸，产生了右侧异常区域
- 缺少精确控制每列宽度的机制，导致布局不稳定

**解决方案：**
1. 采用CSS Grid布局替代Flex布局:
   - 使用`display: grid`创建表格式布局
   - 设置`grid-template-columns: 70px repeat(7, 1fr)`精确控制列宽
   - 时间轴固定70px宽度，其余7列平均分配可用空间

2. 优化元素结构:
   - 移除不必要的嵌套div和多余的宽度类
   - 统一每列的边框和内边距设置
   - 添加`.no-padding-right`类解决右侧溢出问题

3. 简化样式定义:
   - 直接在元素上应用边框样式，不依赖预定义类
   - 使用`last:border-r-0`确保最右列没有右边框

**优化效果：**
- 课程表右侧不再有异常的填充区域
- 所有星期列宽度均匀分布，布局更加协调
- 列宽自动适应屏幕大小，改善了响应式体验
- 整体表格结构更加清晰，视觉上更符合表格的直觉认知

### 2025年4月15日 - 课程表显示空间优化

**问题：**
- 课程表左右两侧存在不必要的留白空间，浪费了可用显示区域
- 部分课程卡片内容被截断，特别是预约按钮文本
- 列宽不足以完整显示课程信息，导致文本被挤压

**原因：**
- 课程表容器设置了左右边距（mx-0 sm:mx-4），限制了有效宽度
- 周几列宽度设置不足（w-32 md:w-40），无法容纳全部内容
- 元素缺少适当的弹性布局和溢出控制

**解决方案：**
1. 移除课程表容器的左右边距：
   - 删除`mx-0 sm:mx-4`边距设置
   - 让表格充分利用整个可用空间

2. 增加周几列宽度：
   - 将列宽从`w-32 md:w-40`调整为`w-40 md:w-48`
   - 最小宽度从140px增加到170px
   - 确保所有课程内容有足够的显示空间

3. 改进课程卡片内部布局：
   - 为按钮添加`whitespace-nowrap`防止文本换行
   - 为图标添加`flex-shrink-0`确保不会被压缩
   - 调整元素间距和弹性布局，确保内容对齐

4. 优化响应式布局：
   - 设置`.schedule-container`的`min-width: 100%`
   - 移除固定的`min-width: 1350px`限制
   - 确保在各种屏幕尺寸下都能适当显示

**优化效果：**
- 课程表完全填充可用空间，无多余留白
- 按钮文本完整显示，不再被截断
- 课程信息布局更加合理，内容清晰可读
- 整体用户体验更加连贯和专业

### 2025年4月14日 - 课程表组件最终优化

**问题：**
- 时间轴宽度过窄，导致时间数字显示不完整或挤压
- 课程表总宽度计算未考虑时间轴宽度，导致轻微溢出问题
- 预约按钮在某些情况下显示不完整

**原因：**
- 时间轴容器宽度固定为16px，不足以完整显示时间文本
- 课程表总宽度计算只考虑了周几列的宽度，未包含时间轴宽度
- 样式定义分散，导致样式覆盖和不一致问题

**解决方案：**
1. 增加时间轴宽度:
   - 将时间轴宽度从16px增加到24px
   - 调整时间标签的位置和样式，确保完整显示

2. 优化总体宽度计算:
   - 将课程表最小宽度从1270px调整为1350px
   - 确保所有内容（包括时间轴和所有周几列）都能完整显示

3. 重构样式定义:
   - 简化样式结构，减少嵌套和重复
   - 统一使用字符串形式定义样式，提高可维护性
   - 为各列添加合理的边框样式，提升视觉分隔效果

4. 优化预约按钮显示:
   - 确保按钮文本使用`whitespace-nowrap`防止换行
   - 调整按钮容器布局，适应不同尺寸的课程卡片

**优化效果：**
- 时间轴显示更加清晰，时间数字完整可见
- 整个课程表可以完整显示，无溢出问题
- 预约按钮在各种尺寸的课程卡片中都能正确显示
- 整体界面更加统一美观，视觉分隔更清晰

### 2025年4月13日 - 课程表布局结构优化

**问题：**
- 课程表宽度受到max-w-7xl限制，导致星期日内容溢出
- 课程表高度被固定值限制，无法自然向下延伸
- 课程卡片位置和尺寸不准确，特别是1小时课程显示不完整

**原因：**
- 布局使用了固定宽度容器，未考虑内容实际需要的空间
- 使用了固定高度而非自适应高度，限制了内容展示
- 课程卡片位置计算使用百分比，在不同容器尺寸下表现不一致

**解决方案：**
1. 移除宽度限制，改为自适应布局：
   - 去除max-w-7xl等宽度限制类
   - 将容器样式改为自动适应内容宽度
   - 添加最小宽度确保所有日期列都能完整显示

2. 改进高度计算方式：
   - 将固定高度改为根据内容自动计算
   - 使用CSS变量动态设置时间表的高度
   - 确保课程表可以自然向下延伸，不受父容器限制

3. 优化课程卡片定位：
   - 将基于百分比的定位改为基于像素的绝对定位
   - 为每30分钟的时间段分配固定的60px高度
   - 确保即使是1小时的课程也有足够的显示空间（最小高度110px）

4. 改进时间轴和网格线：
   - 使用固定像素间隔而非百分比定位时间标签
   - 为整点和半点应用不同的视觉样式
   - 确保网格线与时间标签精确对齐

**优化效果：**
- 完全解决了星期日溢出问题，所有日期列都能完整显示
- 课程表高度自动适应课程数量，可以自然向下延伸
- 课程卡片位置更加精确，不同长度的课程都能完整显示
- 整体布局更加合理，适应各种屏幕尺寸
- 用户体验显著提升，可以查看完整课程信息

### 2025年4月12日 - 课程表与课程卡片UI优化

**问题：**
- 课程表组件存在不必要的滚动条和溢出问题，影响用户体验
- 课程卡片信息展示不够清晰，视觉效果较差
- 移动端适配不佳，界面混乱
- 组件配色与网站主题不匹配，缺乏一致性
- 时间轴刻度不够明显，1小时课程卡片显示不完整

**原因：**
- 布局结构设计不合理，导致元素溢出
- 信息层级不分明，缺乏视觉引导
- 响应式布局实现不完善
- 颜色主题未与全站风格统一（黄色#F59E0B主题）
- 时间轴高度和课程卡片最小高度设置不合理

**解决方案：**
1. 重构课程表组件的布局结构：
   - 优化滚动区域，避免出现不必要的滚动条和溢出问题
   - 调整组件高度为固定值700px，提供足够空间显示课程
   - 使用更合理的Flex布局，优化元素排列
   - 增加课程卡片最小高度，保证信息完整显示

2. 美化课程卡片显示：
   - 将图标颜色更改为黄色系（#F59E0B），增强视觉一致性
   - 改进信息分组和间距，提高可读性
   - 优化容量显示，满员情况下使用红色高亮提示
   - 为课程描述添加分隔线，使结构更清晰
   - 确保操作按钮文本不会换行

3. 增强视觉体验：
   - 添加悬停效果增强交互反馈
   - 将星期标题背景改为黄色系，提高辨识度
   - 优化按钮样式，使用黄色作为主色调
   - 底部添加图例，帮助用户理解不同状态

4. 统一网站配色：
   - 将课程表和课程卡片的主色调调整为黄色（#F59E0B）
   - 预约、取消等按钮采用一致的黄色系设计
   - 课程状态标识采用黄色系标记
   - 同步更新图示和指示器的配色方案

5. 改进时间轴设计：
   - 区分整点和半点时间刻度，增加可读性
   - 为整点添加实线，半点添加虚线，提高视觉层次
   - 整点时间使用加粗字体，半点时间使用较小字体
   - 确保足够的时间刻度高度，使1小时课程卡片完整显示

**优化效果：**
- 视觉效果更加清晰美观，信息层次分明
- 响应式布局更加合理，移动端体验提升
- 课程信息更加直观，重要信息一目了然
- 整体界面更加专业和现代化，与网站整体风格保持一致
- 溢出问题得到解决，各种屏幕尺寸下显示正常
- 时间轴清晰可读，帮助用户更好地辨识课程时间

### 2025年4月10日 - 课程时间表示重构

**问题：**
- 当前课程表使用固定时间格式，无法灵活适应不同时间段的课程
- 时间显示方式不直观，用户难以快速识别课程时间分布
- 移动设备上的显示效果不佳，滑动体验较差

**原因：**
- 使用固定单元格的表格式布局限制了时间表示的灵活性
- 缺乏自适应的时间轴设计，无法直观反映课程时长
- 移动端优化不足，导致界面溢出和交互不便

**解决方案：**
1. 核心功能重构：
   - 重写课程表核心组件，采用基于时间轴的自适应布局
   - 修改课程表单，允许管理员和舞种领队设置任意时间
   - 添加自定义时间输入和预设时间选择功能

2. 课程卡片位置计算：
   - 实现课程卡片的相对布局定位，根据时间精确映射
   - 课程卡片高度根据时长自适应调整
   - 动态时间标记代替固定单元格

3. 移动端显示优化：
   - 实现水平滚动功能，优化移动设备浏览体验
   - 优化触摸交互，提升移动操作流畅度
   - 自适应信息展示，确保重要信息在各种屏幕尺寸下清晰可见

**改进效果：**
- 支持不规则课程时间，提高时间表示灵活性
- 更清晰展示每日时间分布，增强时间信息直观性
- 优化用户体验，提高信息显示效率

### 2025年4月7日 - 用户管理页面舞种更新问题修复

**问题：**
- 在用户管理页面，更改用户角色和舞种类型时，舞种类型无法正确传输到后端

**原因：**
- 前端API调用中使用了`danceType`字段，而后端接口需要的是`dance_type`字段
- 两个字段同时存在于User类型定义中，但API调用时使用了不一致的字段名

**解决方案：**
1. API层修复：
   - 更新`updateUserRole`方法，确保同时包含`dance_type`和`danceType`字段
   - 当接收到带有`danceType`的数据时，自动复制到`dance_type`字段

2. 用户管理页面修复：
   - 修改`handleUpdateUserRole`函数，确保在API调用中包含正确的字段名
   - 更新用户表格数据渲染逻辑，处理两种可能的字段名

3. 类型定义优化：
   - 更新`User`类型定义，包含两种字段名以确保兼容性
   - 为`updateUserRole`方法添加更灵活的参数类型

**改进效果：**